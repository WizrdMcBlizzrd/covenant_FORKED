<div class="bg-spam-bone rounded-xl border-4 border-spam-navy p-6" data-testid="order-panel">
  <% const headerClass = order.status === 'pending' ? 'bg-spam-yellow border-spam-navy text-spam-navy' : 'bg-spam-green border-spam-navy text-spam-bone' %>
  <div class="border-3 rounded-lg px-4 py-3 <%= headerClass %>" data-testid="order-banner">
    <div class="font-display text-sm"><%= order.status === 'pending' ? 'This inscription purchase is pending' : 'This inscription has sold' %></div>
  </div>
  <dl class="mt-4 space-y-3" data-testid="order-details">
    <% const statusClass = order.status === 'pending' ? 'text-spam-yellow' : (order.status === 'confirmed' ? 'text-spam-green' : 'text-spam-navy') %>
    <div>
      <dt class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Status</dt>
      <dd class="mt-1 font-display text-sm <%= statusClass %>"><%= order.status %></dd>
    </div>
    <div>
      <dt class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Price</dt>
      <dd class="mt-1 font-display text-sm text-spam-yellow"><%= formatSats(order.price_sats) %></dd>
    </div>
    <div>
      <dt class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Buyer</dt>
      <dd class="mt-1 font-body text-xs text-spam-navy break-all"><%= order.buyer_address %></dd>
    </div>
    <div>
      <dt class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Transaction</dt>
      <dd class="mt-1">
        <a class="block font-body text-xs text-spam-green no-underline hover:text-spam-green-dark break-all" target="_blank" rel="noopener" href="https://mempool.space/tx/<%= order.txid %>" title="<%= order.txid %>"><%= shortHash(order.txid) %></a>
      </dd>
    </div>
    <% if (order.created_at) { %>
      <% const createdIso = new Date(order.created_at * 1000).toISOString() %>
      <% const createdHuman = new Date(order.created_at * 1000).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC' }) %>
      <div>
        <dt class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Created</dt>
        <dd class="mt-1 font-body text-xs text-spam-navy"><time datetime="<%= createdIso %>"><%= createdHuman %></time></dd>
      </div>
    <% } %>
  </dl>

  <% const extra = JSON.parse(order.extra_details || '{}') %>
  <% const optionalPayments = extra.optional_payments || [] %>
  <% if (optionalPayments.length > 0) { %>
    <div class="mt-4 border-t-3 border-spam-navy pt-4" data-testid="order-optional-payments">
      <div class="font-display text-xs text-spam-green-dark uppercase tracking-wide">Additional Payments</div>
      <dl class="mt-3 space-y-2">
        <% optionalPayments.forEach((p) => { %>
          <div class="flex items-baseline justify-between gap-3 bg-spam-cream border-2 border-spam-navy rounded-lg px-3 py-2">
            <dt class="min-w-0 truncate font-body text-sm font-bold text-spam-navy"><%= p.title %></dt>
            <dd class="shrink-0 font-display text-sm text-spam-green"><%= formatSats(p.amount) %></dd>
          </div>
        <% }) %>
      </dl>
    </div>
  <% } %>
</div>
